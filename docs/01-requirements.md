## 상품 목록 조회 GET /api/v1/products
### [유저 시나리오]  
    - 사용자가 상품 목록을 본다.
    - 보여지는 상품 목록의 개별 데이터에는 [품절여부, 브랜드명, 상품 썸네일, 상품명, 상품가격, 상품 좋아요 갯수]가 보인다.
    - 상품을 최신(등록일)순, 가격 오름차순, 좋아요순 중 택1 정렬할 수 있다.

### [기능 목록]
    1. 정렬 옵션을 확인한다.(다음 중 택1: 최신(등록일)순, 가격 오름차순, 좋아요순)
    2. 상품들의 목록을 반환한다. 
        (1) 브랜드정보 [브랜드코드, 브랜드명]
        (2) 상품정보  [상품코드, 색상, 치수, 품절여부, 상품 썸네일, 상품명, 상품가격, 상품 좋아요 갯수, 상품 카테고리명, 상품 등록일]

## 상품 정보 조회 GET /api/v1/products/{productId}
### [유저 시나리오]
    - 사용자는 브랜드에 대한 소개를 본다.
    - 사용자는 브랜드명을 클릭하여 브랜드 상세페이지로 이동할 수 있다.
    - 사용자는 상품 상세 정보를 본다.

### [기능 목록]
      1. 상품코드가 존재하는지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 상품코드로 특정 상품의 정보를 반환한다.
           (1) 브랜드정보 [브랜드코드, 브랜드 썸네일, 브랜드명, 브랜드 설명, 브랜드 상세페이지 URL]
           (2) 상품상세정보 [상품코드, 색상, 치수, 품절여부, 상품 사진들, 상품명, 상품가격, 상품 좋아요 갯수, 상품 카테고리명, 상품 등록일, 상품 상세설명]

## 브랜드 정보 조회 GET /api/v1/brands/{brandId}
### [유저 시나리오]
    - 사용자는 브랜드에 대한 소개를 본다.
    - 사용자는 브랜드에 속한 상품 목록들을 본다.

### [기능 목록]
      1. 브랜드코드가 존재하는지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 브랜드코드로 브랜드 정보를 반환한다.
        (1) 브랜드정보 [브랜드코드, 브랜드 썸네일, 브랜드명, 브랜드 설명]
        (2) 브랜드에 속한 상품 목록들을 반환한다.

## 상품 좋아요 등록 POST /api/v1/products/{productId}/likes
### [유저 시나리오]
    - 사용자는 상품에 대해 하트(좋아요)를 누른다.

### [기능 목록]
      1. 로그인한 사용자인지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 존재하는 상품인지 확인한다.
          - (성공) 계속 진행한다.
          - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      3. [사용자, 해당 상품]에 대해 좋아요가 등록되어있는지 조회한다.
      4. 좋아요가 등록되어 있는지 확인한다.
         - (성공) 미등록이라면,
            (1) [사용자, 해당 상품]에 대해 좋아요 등록한다.
            (2) 상품에 대한 좋아요 수 +1 더한다.
         - (실패) 존재한다면, 오류를 반환한다.

## 상품 좋아요 취소 DELETE /api/v1/products/{productId}/likes
### [유저 시나리오]
    - 사용자가 이미 좋아요한 상품을 다시 누르면 좋아요가 취소된다.

### [기능 목록]
      1. 로그인한 사용자인지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 존재하는 상품인지 확인한다.
          - (성공) 계속 진행한다.
          - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      3. [사용자, 해당 상품]에 대해 좋아요가 등록되어있는지 조회한다.
      4. 좋아요가 등록되어 있는지 확인한다.
         - (성공) 존재한다면,
            (1) [사용자, 해당 상품]에 대해 좋아요 삭제한다.
            (2) 상품에 대한 좋아요 수를 -1로 차감한다.
         - (실패) 미등록이라면, 오류를 반환한다.

## 주문 생성 및 결제 흐름 (재고 차감, 포인트 차감, 외부 시스템 연동)
## 주문하기 POST /api/v1/orders
### [유저 시나리오]
      1. 로그인한 사용자가 주문할 상품들을 선택하고 '주문하기' 버튼을 누른다.
      2. 주문 성공/실패 정보 화면을 본다.

### [기능 목록]
      1. 로그인한 사용자인지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 주문한 상품코드에 대한 재고를 확인한다.
      3. 해당 상품코드에 대해 주문한 수량과 재고를 비교한다. (재고 >= 주문수량)
          - (성공) 재고가 충분하다면 그대로 진행한다.
          - (실패)
               - 재고가 부족한 상품이 존재하면 해당 상품을 제외하고 진행한다.
               - 진행 가능한 상품이 0개라면 '주문 가능한 상품이 없습니다. (원인: 재고 부족)' 에러메시지를 반환한다.
      4. 사용자의 포인트 잔액을 확인한다.
      5. 포인트가 충분한지 확인한다. (포인트 잔액 >= 총 주문금액)
          - (성공) 포인트가 충분하다면 그대로 진행한다.
          - (실패) 그 외 '포인트 잔액 부족' 에러메세지를 반환한다.
      6. 최종 주문을 진행한다.
          - (성공) 결제 성공시
              (1) 해당 상품의 주문수량만큼 재고 차감
              (2) 총 주문금액만큼 포인트 차감
              (3) 주문 성공 메세지를 반환한다.
                  - 성공 메세지에 주문에 포함된(상품, 수량) 과 주문에서 제외된(상품, 수량, 원인)을 반환한다.
          - (실패) 주문 실패시 에러메세지를 반환한다.

## 유저의 주문 목록 조회 GET /api/v1/orders
### [유저 시나리오]
      1. 로그인한 사용자가 과거 주문 목록을 조회한다. [주문일, 상품(썸네일, 상품명, 수량), 총 결제금액]

### [기능 목록]
      1. 로그인한 사용자인지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 사용자의 주문내역을 최신순으로 조회한다.
        - 주문번호들을 조회한다.
        - 주문번호를 순회하며 총 결제금액과 하위 주문항목들을 조회한다.
        - 주문일과 주문항목별 상품정보(썸네일, 상품명, 수량)을 가져온다.

## 단일 주문 상세 조회 GET /api/v1/orders/{orderId}
### [유저 시나리오]
      1. 로그인한 사용자가 주문 목록 조회 화면에서 '주문 상세' 버튼을 누르고 상세내역을 조회한다.

### [기능 목록]
      1. 로그인한 사용자인지 확인한다.
         - (성공) 계속 진행한다.
         - (실패) 오류를 반환하고 더 이상 진행하지 않는다.
      2. 주문번호로 세부 내역을 조회한다.
          - 주문일시, 주문상태를 조회한다.
          - 주문항목(썸네일, 상품명, 수량, 가격, 총 금액)들을 조회한다.
          - 총 결제금액, 결제상태를 조회한다.

## 공통
### [비기능적 요구사항]
 - 사용자 인증은 X-USER-ID Header 기반으로 처리된다.
 - 오류 상황에서는 명확한 HTTP 상태코드와 에러메세지를 반환해야 한다.

  | 케이스                | 설명                                                | HTTP 상태코드                 |
  |--------------------|---------------------------------------------------|---------------------------|
  | 포인트 잔액 부족          | 총 주문금액 > 포인트 잔액                                   | 400 BAD REQUEST           |
  | 주문 가능 상품 0개        | 주문하기 > 모든 상품 재고 부족 > 주문 가능한 상품이 없으므로, 주문 진행이 무의미함 | 400 BAD REQUEST           |
  | 비로그인               | 인증 헤더 없음, 해당 유저 존재하지 않음                           | 401 UNAUTHORIZED          |
  | 상품, 브랜드 미존재        | 잘못된 productId 또는 brandId                          | 404 NOT FOUND             |
  | 좋아요가 이미 존재, 이미 미존재 | 좋아요 등록 시도시 이미 존재하거나, 삭제 시도시 이미 존재하지 않음            | 409 CONFLICT              |
  | 기타 주문 실패           | 주문 과정 중 비식별 예외                                    | 500 INTERNAL SERVER ERROR |

### [유비쿼터스 언어]
| 한글 용어 | 영문 용어     | 설명                        |
|-------|-----------|---------------------------|
| 회원    | User      | 서비스를 이용하는 사용자             |
| 상품    | Product   | 서비스에서 판매하는 대상             |
| 브랜드   | Brand     | 상품을 판매하는 주체               |
| 좋아요   | Like      | 사용자가 특정 상품에 대해 선호를 표현한 상태 |
| 재고    | Stock     | 상품의 판매 가능한 수량             |
| 포인트   | Point     | 사용자가 상품 구매에 사용할 수 있는 자산   |
| 주문    | Order     | 사용자의 상품 구매 요청 단위          |
| 주문 항목 | OrderItem | 주문에 포함된 개별 (상품, 수량) 정보    |
| 결제    | Payment   | 주문에 대한 상품 대금 총액 지불        |